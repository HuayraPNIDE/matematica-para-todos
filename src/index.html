<!doctype html>
<html>
  <head>
  <script src="./js/socket.io/socket.io-1.2.0.js"></script>
    <title>Matematica para todos - MXT</title>
	<script>
		function init()
		{
			var local_ip = require('my-local-ip')()
			var socket = io("http://"+local_ip+":3000");

			registrar_espera(socket);
		}

		function elegir_amigo() {
			var amigo = document.getElementById('amigo').value;
			var socket = io("http://"+amigo+":3000");

			registrar_espera(socket);
		}

		function registrar_espera(socket) {

			socket.on('connect', function() {
				console.log('Me conecte al servidor');
				console.log('Registro eventos:\nlisto\nretiro\nmano');

				socket.on('listo', function(arr) {

					document.getElementById("amigo").style.visibility = "hidden";
					document.getElementById("btn_elegir").style.visibility = "hidden";
					
					document.getElementById('titulo').innerHTML = 'Arranca el juego';
					document.getElementById('nombres').innerHTML = arr[0]+' VS. '+arr[1];
				});

				socket.on('retiro', function(msg) {
					document.getElementById('titulo').innerHTML = msg + ' Se retiro';
					document.getElementById('nombres').innerHTML = "";
				});

				socket.on('mano', function(o) {
					console.log(JSON.stringify(o, null, 2));
					console.log('Respondo'); 
					socket.emit('respuesta', {my: 'data'});
				});

			});

			

		}
	</script>

  </head>
  <body onload="init()">
	<h1 id="titulo">Amigos</h1>
	<input type="text" id="amigo">
	<input type="submit" value="Elegir" id="btn_elegir" onclick="elegir_amigo()">

	<p id="nombres"></p>
  </body>
</html>
